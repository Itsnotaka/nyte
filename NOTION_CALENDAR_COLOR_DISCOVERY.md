# Notion Calendar Color Discovery (Deep Dive)

This run follows the same discovery pattern as LINEAR_UI_DISCOVERY.md, but scoped only to color palettes and token architecture.

## Goal

Extract concrete color values and theme-token patterns from Notion Calendar.app, then translate those findings into a token-management strategy for Nyte’s shadcn-based theme system (tooling/tailwind/theme.css).

## Scope

- In scope: palette values, token architecture, light/dark strategy, semantic role mapping.
- Out of scope: layout/spacing/interaction replication.

## Paths Used

- App bundle: /System/Volumes/Data/Applications/Notion Calendar.app
- Electron bundle: /System/Volumes/Data/Applications/Notion Calendar.app/Contents/Resources/app.asar
- Local app data: ~/Library/Application Support/Notion Calendar
- Service worker cache: ~/Library/Application Support/Notion Calendar/Service Worker/ScriptCache
- Temporary extract: /tmp/notion-calendar-asar
- Temporary downloaded assets: /tmp/notion-calendar-assets
- Current Nyte theme: /Users/workgyver/Developer/nyte/tooling/tailwind/theme.css

---

## 1) Inspect the Electron Bundle

### Checks

```bash
ls -la '/System/Volumes/Data/Applications/Notion Calendar.app/Contents/Resources'
npx --yes asar extract \
  '/System/Volumes/Data/Applications/Notion Calendar.app/Contents/Resources/app.asar' \
  /tmp/notion-calendar-asar
```

### Key discovery

- /tmp/notion-calendar-asar/build/main/offline.html contains fallback UI token values.
- It includes this note: root styles are copied from a canonical design token source (`StyleSheet.txt`) and manually synced.

### Offline fallback token subset (evidence)

- `--material-default`
- `--text-default`
- `--text-detail`
- `--text-body`
- `--object-default`
- `--object-highlight`
- `--object-active`
- `--object-highlight-bg`
- Gray scale: `--gray70` → `--gray900`

This confirms a semantic token layer exists in the shipped app shell, even outside main runtime bundles.

---

## 2) Discover Runtime Web Assets via Service Worker Cache

### Checks

```bash
ls -la "$HOME/Library/Application Support/Notion Calendar/Service Worker/ScriptCache"
```

Active cache files included:

- `4ee8af3923ea8d5b_1` (contains current asset manifest references)

### Manifest extraction result

From ScriptCache, current web assets resolve under:

- `https://calendar.notion.so/assets/*.js`

Downloaded runtime set (non-locale chunks): 29 JS files including:

- `cron-9b07b0fefd25d7cf6b3a.js` (main bundle)
- `221-9ac570f014e344dfa4cd.js` (large chunk with shared modules)
- additional lazy chunks.

---

## 3) Extracted Token Statistics (from cron main bundle)

From `cron-9b07b0fefd25d7cf6b3a.js`:

- **731** unique CSS custom properties (`--*`)
- **512** `--nds-*` tokens (design-system core)
- **219** non-`nds` tokens (bridging/app-specific)
- **359** tokens with explicit dark overrides in `.dark` blocks

This is a large, layered system, not a flat palette.

---

## 4) Core Color Architecture Found in Notion Calendar

## 4.1 `nds-*` token families (core)

Main families observed:

- `nds-surface-*`
- `nds-text-*`
- `nds-icon-*`
- `nds-stroke-*`
- `nds-fill-*`
- `nds-state-*`
- `nds-shadow-*`
- `nds-tint-*`
- hue scales (`nds-uiBlue-*`, `nds-red-*`, `nds-green-*`, `nds-yellow-*`, `nds-orange-*`, `nds-purple-*`, `nds-pink-*`, `nds-brown-*`)
- neutral systems (`nds-gray-*`, `nds-translucentGray-*`, `nds-transparentGray-*`)

## 4.2 Dark mode pattern is explicit, not inverted

Pattern repeatedly used:

- Light token: `--nds-foo: <light-value>`
- Contrast token: `--nds-foo-contr: <dark-side-value>`
- Dark remap: `.dark { --nds-foo: var(--nds-foo-contr) }`

This is important: dark mode is authored as a first-class palette, not generated by transforming light values.

## 4.3 Neutral palette character

The neutrals are warm-tinted in light mode and alpha-layered heavily:

- `nds-gray-30`: `rgba(84,72,49,0.04)`
- `nds-gray-100`: `rgba(84,72,49,0.15)`
- `nds-gray-400`: `rgba(71,70,68,0.6)`
- `nds-gray-900`: `rgba(29,27,22,1)`

Dark side equivalents are explicit opaque anchors (e.g. 21/25/32/37/55/90...).

## 4.4 Resolved semantic roles (light vs dark)

| Role                 | Light               | Dark (resolved)         |
| -------------------- | ------------------- | ----------------------- |
| material-default     | rgba(255,255,255,1) | rgba(25,25,25,1)        |
| text-default         | rgba(50,48,44,1)    | rgba(255,255,255,0.81)  |
| text-body            | rgba(120,119,116,1) | rgba(255,255,255,0.445) |
| object-default       | rgba(71,70,68,0.6)  | rgba(255,255,255,0.445) |
| object-highlight-bg  | rgba(0,0,0,0.04)    | rgba(255,255,255,0.05)  |
| nds-surface-elevated | rgba(255,255,255,1) | rgba(37,37,37,1)        |
| nds-stroke-secondary | rgba(84,72,49,0.08) | rgba(255,255,255,0.055) |
| nds-state-hover      | rgba(0,0,0,0.04)    | rgba(255,255,255,0.05)  |
| nds-state-pressed    | rgba(0,0,0,0.08)    | rgba(255,255,255,0.08)  |

## 4.5 Accent behavior

Primary interactive blue ramp:

- `nds-uiBlue-100`: `rgba(35,131,226,0.07)`
- `nds-uiBlue-200`: `rgba(35,131,226,0.14)`
- `nds-uiBlue-300`: `rgba(35,131,226,0.21)`
- `nds-uiBlue-400`: `rgba(35,131,226,0.35)`
- `nds-uiBlue-600`: `rgba(35,131,226,1)`

Calendar/event tokens:

- `calendar-green`: `#48CA80`
- `calendar-orange`: `#FE7032`
- `calendar-yellow`: `#F2B728`
- `calendar-red`: `#CD3C3A`
- `calendar-text-red`: `#BD4841` (dark override: `#DA615D`)

## 4.6 App-specific bridge tokens

Non-`nds` token layer bridges DS tokens into calendar-specific surfaces:

- grid lines: `layout-line-grid-v/h/*`
- shell/background: `material-default`
- semantic aliases: `text-default`, `object-default`, `input-border`
- “public” token subset for marketing/landing contexts (`public-*`)

---

## 5) Extra Evidence from App Asset Catalog (Assets.car)

The native macOS asset catalog does **not** contain the full runtime UI theme palette.
It mostly contains app icon resources and two grayscale colors used for icon stack rendering:

- extended gray `1.0` (white)
- extended gray `0.15` (dark gray)

Conclusion: runtime palette authority is in web bundles/tokens, not native asset colors.

---

## 6) What this means for Nyte’s current theme.css

Current Nyte file combines:

- shadcn core tokens (`--background`, `--foreground`, `--card`, `--border`, etc)
- custom shell tokens (`--color-shell-bg`, `--color-main-bg`, etc)
- two theming mechanisms (`.dark` + `[data-theme="dark"]`)

This works, but it is flatter and less role-segmented than Notion’s system.

Key gap vs Notion approach:

- missing explicit contrast token pairs (`*-contr-*` style)
- fewer alpha-layer semantic roles (hover/pressed/stroke/fill separation)
- color decisions mixed directly into component-facing tokens

---

## 7) Recommended Token Management Model for Nyte

Use a 3-layer model while preserving shadcn compatibility.

## 7.1 Layer A — Primitives (`--ref-*`)

Raw palette only:

- neutral scales
- accent scales
- alpha constants
- shadows

Example:

- `--ref-gray-30`
- `--ref-gray-900`
- `--ref-ui-blue-600`
- `--ref-alpha-white-55`

## 7.2 Layer B — System/Semantic (`--sys-*`)

Role-based tokens:

- `--sys-surface-page`
- `--sys-surface-elevated`
- `--sys-text-primary`
- `--sys-text-secondary`
- `--sys-stroke-primary`
- `--sys-stroke-secondary`
- `--sys-state-hover`
- `--sys-state-pressed`
- `--sys-focus-ring`

## 7.3 Layer C — Component (`--cmp-*`)

App surface/component slots, all aliasing `--sys-*`:

- `--cmp-shell-bg`
- `--cmp-sidebar-bg`
- `--cmp-grid-line-v`
- `--cmp-event-chip-bg`
- `--cmp-input-border`

## 7.4 Compatibility aliases (keep shadcn API stable)

Map existing shadcn contract to system tokens:

- `--background: var(--sys-surface-page)`
- `--foreground: var(--sys-text-primary)`
- `--card: var(--sys-surface-elevated)`
- `--card-foreground: var(--sys-text-primary)`
- `--border: var(--sys-stroke-secondary)`
- `--input: var(--sys-stroke-secondary)`
- `--ring: var(--sys-focus-ring)`

Then map custom Nyte shell tokens to component layer:

- `--color-shell-bg -> --cmp-shell-bg`
- `--color-sidebar-bg -> --cmp-sidebar-bg`
- `--color-main-bg -> --cmp-main-bg`
- `--color-inset-bg -> --cmp-inset-bg`
- `--color-rail -> --cmp-rail`

---

## 8) Proposed First Palette Port (high-impact subset)

Start with this Notion-derived subset to get immediate parity without importing 700+ tokens:

1. Neutrals

- `sys-surface-page`
- `sys-surface-elevated`
- `sys-surface-wash`
- `sys-text-primary`
- `sys-text-secondary`
- `sys-stroke-primary`
- `sys-stroke-secondary`

2. Interaction

- `sys-state-hover`
- `sys-state-pressed`
- `sys-focus-ring` (built from blue stroke + blue tint)

3. Accent

- `sys-accent-primary` (uiBlue-600)
- `sys-accent-primary-hover` (uiBlue-700)

4. Calendar-specific

- `cmp-grid-line-v/h` + weekend variants
- event colors (`calendar-*`)

---

## 9) Migration Risks / Pitfalls

1. **Double-alpha layering**
   - Many source tokens are already RGBA. Combining with additional Tailwind opacity utilities can over-fade.

2. **Dark mode mismatch**
   - Notion tokens rely on explicit remaps; simple inversion or one-step conversion will drift visually.

3. **Dual theme sources**
   - Keeping both `.dark` and `[data-theme]` unsynchronized can produce split behavior.

4. **Semantic collapse**
   - Mapping everything straight into `primary/secondary/muted` loses role granularity and makes future tuning harder.

---

## 10) Practical Rollout Plan

1. **Audit**
   - Inventory all token usage in apps/desktop and shared UI components.

2. **Introduce layers**
   - Add `ref`, `sys`, `cmp` token groups in theme.css (no component rewrites yet).

3. **Alias existing tokens**
   - Keep current shadcn token names and existing `--color-*` variables, but point them to `sys/cmp`.

4. **Swap component-by-component**
   - Shell/sidebar/grid first, then forms/popovers/menus.

5. **Cleanup**
   - Remove dead aliases after visual diff pass.

---

## 11) Thought Summary

Notion Calendar’s palette system is strong because color is authored as a semantic graph (surface/text/stroke/fill/state) with explicit dark counterparts, not as isolated hex values. The main opportunity for Nyte is not just copying colors, but adopting this layered token topology so shadcn remains stable while your app gets richer, more controllable color behavior.

If the next step is implementation, start by introducing `ref/sys/cmp` aliases in tooling/tailwind/theme.css while preserving every existing token contract, then migrate component usage incrementally.
